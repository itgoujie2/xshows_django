; Supervisor configuration for XShows Django project (Local Development)
; To run: supervisord -c supervisord.conf
; To control: supervisorctl -c supervisord.conf status

[unix_http_server]
file=/Users/jiegou/Downloads/xshows_django/supervisor.sock

[supervisord]
logfile=/Users/jiegou/Downloads/xshows_django/logs/supervisord.log
logfile_maxbytes=10MB
logfile_backups=3
loglevel=info
pidfile=/Users/jiegou/Downloads/xshows_django/supervisord.pid
nodaemon=false

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///Users/jiegou/Downloads/xshows_django/supervisor.sock

; ============================================
; Django Application (Gunicorn)
; ============================================
[program:xshows-django]
command=/Users/jiegou/Downloads/xshows_django/venv/bin/python manage.py runserver 0.0.0.0:8000
directory=/Users/jiegou/Downloads/xshows_django
user=jiegou
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/Users/jiegou/Downloads/xshows_django/logs/django.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=3
environment=PATH="/Users/jiegou/Downloads/xshows_django/venv/bin"

; ============================================
; Celery Worker
; ============================================
[program:xshows-celery-worker]
command=/Users/jiegou/Downloads/xshows_django/venv/bin/celery -A xshows worker -l info --concurrency=2
directory=/Users/jiegou/Downloads/xshows_django
user=jiegou
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/Users/jiegou/Downloads/xshows_django/logs/celery-worker.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=3
environment=PATH="/Users/jiegou/Downloads/xshows_django/venv/bin"
stopwaitsecs=600
; Kill gracefully on stop
stopsignal=TERM

; ============================================
; Celery Beat (Scheduler)
; ============================================
[program:xshows-celery-beat]
command=/Users/jiegou/Downloads/xshows_django/venv/bin/celery -A xshows beat -l info --scheduler django_celery_beat.schedulers:DatabaseScheduler
directory=/Users/jiegou/Downloads/xshows_django
user=jiegou
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/Users/jiegou/Downloads/xshows_django/logs/celery-beat.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=3
environment=PATH="/Users/jiegou/Downloads/xshows_django/venv/bin"
; Kill gracefully on stop
stopsignal=TERM

; ============================================
; Group for all xshows services
; ============================================
[group:xshows]
programs=xshows-django,xshows-celery-worker,xshows-celery-beat
priority=999
